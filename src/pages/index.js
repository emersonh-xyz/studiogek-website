import Head from 'next/head'
import React, { useEffect, useState } from 'react'
import { useSession } from 'next-auth/react'
import fetchUserTier from '@/utils/fetch_user_tier';
import { useRouter } from 'next/router';
import Home from '@/components/Layouts/Pages/Home/Home.js'

export default function App() {

  const { data: session, status } = useSession()

  const [userTier, setUserTier] = useState();
  const [postData, setPostData] = useState([]);
  const [authed, setAuthed] = useState();

  const router = useRouter();

  // Get the current tier of the user
  const getTier = async () => {
    const results = await fetchUserTier();
    setUserTier(results);
  }

  const getAllTiers = async () => {
    const results = await fetch('/api/patreon/admin/creator-tiers')
      .then((res) => res.json())
      .catch((err) => console.log(err))


  }


  useEffect(() => {

    // Call our asyncronous functions
    getTier()
    getAllTiers()

    return () => {
      // this now gets called when the component unmounts
    }


  }, [])
  // Loop over all post data

  return (
    <div>
      <Head>
        <title>Studio Gek | Home</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main>

        <Home />

      </main >


    </div >
  )
}